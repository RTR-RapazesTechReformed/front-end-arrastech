<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Usuário</title>
    <link rel="stylesheet" href="../css/cadastrov2.css">
    <link rel="icon" type="image/x-icon" href="../imgs/logo-arrastao.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <script src="/js/script_api.js"></script>

</head>

<body>
    <div class="floating-circle circle-blue"></div>
    <div class="floating-circle circle-pink"></div>
    <div class="floating-circle circle-yellow"></div>
    <div class="floating-circle circle-red"></div>
    <div class="floating-circle circle-green"></div>
    <div class="floating-circle circle-purple"></div>
    <div class="floating-circle circle-orange"></div> <!-- Nova bola no canto superior esquerdo -->
    <div class="floating-circle circle-teal"></div>
    <div vw class="enabled">
        <div vw-access-button class="active"></div>
        <div vw-plugin-wrapper>
            <div class="vw-plugin-top-wrapper"></div>
        </div>
    </div>
    <header class="header">
        <a href="home.html">
            <img src="../imgs/logo-techJobs.JPG" alt="Logo" class="logo">
        </a>
        <button onclick="window.location.href = 'login.html'" type="button" class="back-btn-top">Login</button>
    </header>
    <div id="alertDiv" class="container_alerta d-none">
        <span class="titulo_alerta">Alerta</span>
        <span class="texto_alerta">Mensagem de alerta aqui!</span>
    </div>
    <div class="container">
        <h2>Cadastro de Usuário</h2>

        <!-- Barra de progresso -->
        <div class="progress-bar-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>

        <div class="user-type">
            <label for="userType">Selecione o Tipo de Usuário:</label>
            <select id="userType" onchange="showForm()">
                <option value="">Escolha uma opção</option>
                <option value="aluno">Aluno</option>
                <option value="recrutador">Recrutador</option>
                <option value="empresa">Empresa</option>
            </select>
        </div>

        <!-- Formulário Aluno -->
        <div id="formAluno" class="form-container">
            <div id="step1" class="step">
                <div class="form-group">
                    <label for="username">Nome do Usuário</label>
                    <input type="text" id="username" name="username" required onblur="updateProgress()">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="firstname">Primeiro Nome</label>
                        <input type="text" id="firstname" name="firstname" required onblur="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label for="lastname">Sobrenome</label>
                        <input type="text" id="lastname" name="lastname" required onblur="updateProgress()">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="cpf">CPF</label>
                        <input type="text" id="cpf" name="cpf" required onblur="formatarCPF()" maxlength="14"
                            onblur="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label for="telefone">Telefone</label>
                        <input type="text" id="telefone" name="telefone" required onblur="formatarTelefone()"
                            maxlength="15" onblur="updateProgress()">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="email">E-mail</label>
                        <input type="email" id="email" name="email" required onblur="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label for="password">Senha</label>
                        <input type="password" id="password" name="password" required onblur="updateProgress()">
                    </div>
                </div>


                <div class="btn-group">
                    <button type="button" onclick="nextStep('formAluno', 1)" class="button">Próxima</button>
                </div>
            </div>

            <!-- Etapa 2: Contato e Endereço -->
            <div id="step2" class="step" style="display:none">

                <div class="form-group">
                    <label for="dataNascimento">Data de Nascimento</label>
                    <input type="text" id="dataNascimento" name="dataNascimento" required
                        onblur="formatarDataNascimento()" maxlength="10" placeholder="DD/MM/AAAA"
                        onblur="updateProgress()">
                </div>
                <div class="form-group">
                    <label for="sexo">Sexo</label>
                    <select name="sexo" id="sexo" required onblur="updateProgress()">
                        <option value="">Selecione o sexo</option>
                        <option value="sexo_masculino">Masculino</option>
                        <option value="sexo_feminino">Feminino</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="etnia">Etnia</label>
                    <select name="etnia" id="etnia" required onblur="updateProgress()">
                        <option value="">Selecione a cor/raça</option>
                        <option value="Branca">Branca</option>
                        <option value="Preta">Preta</option>
                        <option value="Parda">Parda</option>
                        <option value="Amarela">Amarela</option>
                        <option value="Indígena">Indígena</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="escolaridade">Escolaridade</label>
                    <select name="escolaridade" id="escolaridade">
                        <option value="">Selecione a escolaridade</option>
                        <option value="fundamental_incompleto">Ensino Fundamental Incompleto</option>
                        <option value="fundamental_completo">Ensino Fundamental Completo</option>
                        <option value="medio_incompleto">Ensino Médio Incompleto</option>
                        <option value="medio_completo">Ensino Médio Completo</option>
                        <option value="tecnico_incompleto">Ensino Técnico Incompleto</option>
                        <option value="tecnico_completo">Ensino Técnico Completo</option>
                        <option value="superior_incompleto">Ensino Superior Incompleto</option>
                        <option value="superior_completo">Ensino Superior Completo</option>
                    </select>
                </div>
                <div class="btn-group">
                    <button type="button" onclick="previousStep('formAluno', 1)" class="button">Voltar</button>
                    <button type="button" onclick="nextStep('formAluno', 1)" class="button">Próxima</button>
                </div>

            </div>
            <!-- Etapa 3: Contato e Endereço -->
            <div id="step3" class="step" style="display:none">
                <div class="form-group">
                    <label for="cep">CEP</label>
                    <input type="text" id="cep" name="cep" required onblur="formatarCep()" maxlength="9"
                        onchange="buscarCep()" onblur="updateProgress()">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="city">Cidade</label>
                        <input type="text" id="city" name="city" required onblur="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label for="state">Estado</label>
                        <input type="text" id="state" name="state" required onblur="updateProgress()">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="street">Rua</label>
                        <input type="text" id="street" name="street" required onblur="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label for="number">Número</label>
                        <input type="text" id="number" name="number" required onblur="updateProgress()">
                    </div>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="terms" name="terms" required onblur="updateProgress()">
                    <label for="terms">Concordo com os <a
                            href="https://arrastao.org.br/site/wp-content/uploads/2024/07/Politica-de-Governanca-LGPD.pdf"
                            target="_blank" id="terms-link">termos de uso</a> dos meus dados</label>
                </div>

                <div class="btn-group">
                    <button type="button" onclick="previousStep('formAluno', 2)" class="button">Voltar</button>
                    <button type="button" onclick="realizarCadastro()" class="button">Cadastrar</button>
                </div>
            </div>
        </div>
        <!-- Formulário Recrutador -->
        <div id="formRecrutador" class="form-container">
            <!-- Etapa 1: Empresa e Recrutador -->
            <div id="recrutadorStep1" class="step">

                <div class="form-group">
                    <label for="username">Nome do Usuário</label>
                    <input type="text" id="usernameRecruiter" name="username" required onblur="updateProgress()">
                </div>

                <div class="form-group">
                    <label for="firstname">Primeiro Nome</label>
                    <input type="text" id="firstnameRecruiter" name="firstname" required onblur="updateProgress()">
                </div>
                <div class="form-group">
                    <label for="lastname">Sobrenome</label>
                    <input type="text" id="lastnameRecruiter" name="lastname" required onblur="updateProgress()">
                </div>

                <div class="form-group">
                    <label for="cpf">CPF</label>
                    <input type="text" id="cpfRecruiter" name="cpf" required onblur="formatarCPF(event)" maxlength="14">
                </div>

                <div class="btn-group">
                    <button type="button" class="button next-btn"
                        onclick="nextStep('formRecrutador', 1)">Próxima</button>
                </div>
            </div>

            <!-- Etapa 2: Contato Recrutador -->
            <div id="recrutadorStep2" class="step" style="display:none">
                <div class="form-row">
                    <div class="form-group">
                        <label for="cargoUsuario">Cargo do Usuário</label>
                        <input type="text" id="cargoUsuario" name="cargo_usuario" required>
                    </div>
                    <div class="form-group">
                        <label for="telefone">Telefone</label>
                        <input type="text" id="telefoneRecruiter" name="telefone" required
                            onblur="formatarTelefone(event)" maxlength="15">

                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="recruiterEmail">E-mail do Recrutador</label>
                        <input type="email" id="recruiterEmail" name="recruiterEmail" required
                            onblur="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label for="companyEmail">Senha</label>
                        <input type="password" id="passwordRecruiter" name="password" required
                            onblur="updateProgress()">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="company">Empresa</label>
                        <input type="text" id="companyRecruiter" name="company" required onblur="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label for="cnpj">CNPJ da Empresa</label>
                        <input type="text" id="cnpjRecruiter" name="cnpj" required onblur="formatarCNPJ(event)"
                            maxlength="18">
                    </div>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="terms" name="terms" required onblur="updateProgress()">
                    <label for="terms">Concordo com os <a
                            href="https://arrastao.org.br/site/wp-content/uploads/2024/07/Politica-de-Governanca-LGPD.pdf"
                            target="_blank" id="terms-link">termos de uso</a> dos meus dados</label>
                </div>
                <div class="btn-group">
                    <button type="button" class="button back-btn"
                        onclick="previousStep('formRecrutador', 1)">Voltar</button>
                    <button type="button" class="button submit-btn" onclick="realizarCadastro()">Cadastrar</button>
                </div>
            </div>



        </div>
        <!-- Formulário Empresa -->
        <div id="formEmpresa" class="form-container">
            <div id="empresaStep1" class="step">
                <!-- Etapa 1: Empresa -->
                <div class="form-row">
                    <div class="form-group">
                        <label for="companyName">Nome da Empresa</label>
                        <input type="text" id="companyName" name="companyName" required onblur="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label for="cnpj">CNPJ da Empresa</label>
                        <input type="text" id="cnpjCompany" name="cnpj" required onblur="formatarCNPJ(event)"
                            maxlength="18">
                    </div>
                </div>
                <div class="form-row">

                    <div class="form-group">
                        <label for="email">E-mail da Empresa</label>
                        <input type="email" id="companyEmail" name="companyEmail" required onblur="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label for="password">Senha</label>
                        <input type="password" id="passwordCompany" name="password" required onblur="updateProgress()">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="setorIndustria">Setor Industria</label>
                        <input type="text" id="setorIndustria" name="setorIndustria" required onblur="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label for="telefone">Telefone</label>
                        <input type="text" id="telefoneCompany" name="telefone" required
                            onblur="formatarTelefone(event)" maxlength="15">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="firstname">Representante Legal</label>
                        <input type="text" id="firstnameCompany" name="firstname" required onblur="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label for="lastname">Sobrenome</label>
                        <input type="text" id="lastnameCompany" name="lastname" required onblur="updateProgress()">
                    </div>
                </div>

                <div class="btn-group">
                    <button type="button" class="button next-btn" onclick="nextStep('formEmpresa', 1)">Próxima</button>
                </div>
            </div>
            <!-- Etapa 2: Endereço da Empresa -->
            <div id="empresaStep2" class="step" style="display:none">
                <div class="form-group">
                    <label for="cep">CEP</label>
                    <input type="text" id="cepCompany" name="cep" required onblur="formatarCep()" maxlength="9"
                        onchange="buscarCep()" onblur="updateProgress()">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="city">Cidade</label>
                        <input type="text" id="cityCompany" name="city" required onblur="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label for="state">Estado</label>
                        <input type="text" id="stateCompany" name="state" required onblur="updateProgress()">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="street">Rua</label>
                        <input type="text" id="streetCompany" name="street" required onblur="updateProgress()">
                    </div>
                    <div class="form-group">
                        <label for="number">Número</label>
                        <input type="text" id="numberCompany" name="number" required onblur="updateProgress()">
                    </div>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="terms" name="terms" required onblur="updateProgress()">
                    <label for="terms">Concordo com os <a
                            href="https://arrastao.org.br/site/wp-content/uploads/2024/07/Politica-de-Governanca-LGPD.pdf"
                            target="_blank" id="terms-link">termos de uso</a> dos meus dados</label>
                </div>
                <div class="btn-group">
                    <button type="button" class="button back-btn"
                        onclick="previousStep('formEmpresa', 1)">Voltar</button>
                    <button type="button" class="button submit-btn" onclick="realizarCadastro()">Cadastrar</button>
                </div>
            </div>



            <script>
                let currentStepAluno = 1;
                let currentStepRecrutador = 1;
                let currentStepEmpresa = 1;

                const camposAluno = 13;
                const camposRecrutador = 10;
                const camposEmpresa = 13;

                function nextStep(formType) {
                    if (formType === 'formAluno') {
                        if (currentStepAluno < camposAluno) {
                            document.getElementById('step' + currentStepAluno).style.display = 'none';
                            currentStepAluno++;
                            document.getElementById('step' + currentStepAluno).style.display = 'block';
                        }
                    } else if (formType === 'formRecrutador') {
                        if (currentStepRecrutador < camposRecrutador) {
                            document.getElementById('recrutadorStep' + currentStepRecrutador).style.display = 'none';
                            currentStepRecrutador++;
                            document.getElementById('recrutadorStep' + currentStepRecrutador).style.display = 'block';
                        }
                    } else if (formType === 'formEmpresa') {
                        if (currentStepEmpresa < camposEmpresa) {
                            document.getElementById('empresaStep' + currentStepEmpresa).style.display = 'none';
                            currentStepEmpresa++;
                            document.getElementById('empresaStep' + currentStepEmpresa).style.display = 'block';
                        }
                    }
                    updateProgress(formType); // Atualiza a barra de progresso
                }

                // Função para voltar para a etapa anterior
                function previousStep(formType) {
                    if (formType === 'formAluno') {
                        if (currentStepAluno > 1) {
                            document.getElementById('step' + currentStepAluno).style.display = 'none';
                            currentStepAluno--;
                            document.getElementById('step' + currentStepAluno).style.display = 'block';
                        }
                    } else if (formType === 'formRecrutador') {
                        if (currentStepRecrutador > 1) {
                            document.getElementById('recrutadorStep' + currentStepRecrutador).style.display = 'none';
                            currentStepRecrutador--;
                            document.getElementById('recrutadorStep' + currentStepRecrutador).style.display = 'block';
                        }
                    } else if (formType === 'formEmpresa') {
                        if (currentStepEmpresa > 1) {
                            document.getElementById('empresaStep' + currentStepEmpresa).style.display = 'none';
                            currentStepEmpresa--;
                            document.getElementById('empresaStep' + currentStepEmpresa).style.display = 'block';
                        }
                    }
                    updateProgress(formType); // Atualiza a barra de progresso
                }

                // Função para exibir o formulário baseado no tipo de usuário selecionado
                function showForm() {
                    let userType = document.getElementById("userType").value;

                    // Esconde todos os formulários
                    document.getElementById("formAluno").classList.remove("active");
                    document.getElementById("formRecrutador").classList.remove("active");
                    document.getElementById("formEmpresa").classList.remove("active");

                    // Mostra o formulário correspondente
                    if (userType === "aluno") {
                        document.getElementById("formAluno").classList.add("active");
                        resetForm('formAluno');
                    } else if (userType === "recrutador") {
                        document.getElementById("formRecrutador").classList.add("active");
                        resetForm('formRecrutador');
                    } else if (userType === "empresa") {
                        document.getElementById("formEmpresa").classList.add("active");
                        resetForm('formEmpresa');
                    }
                }

                // Função para resetar o formulário e a barra de progresso
                function resetForm(formType) {
                    resetProgress(); // Reseta a barra de progresso

                    if (formType === 'formAluno') {
                        currentStepAluno = 1;
                        document.getElementById('step1').style.display = 'block';
                        document.getElementById('step2').style.display = 'none';
                        document.getElementById('step3').style.display = 'none';
                        document.getElementById('step4').style.display = 'none';
                    } else if (formType === 'formRecrutador') {
                        currentStepRecrutador = 1;
                        document.getElementById('recrutadorStep1').style.display = 'block';
                        document.getElementById('recrutadorStep2').style.display = 'none';
                        document.getElementById('recrutadorStep3').style.display = 'none';
                    } else if (formType === 'formEmpresa') {
                        currentStepEmpresa = 1;
                        document.getElementById('empresaStep1').style.display = 'block';
                        document.getElementById('empresaStep2').style.display = 'none';
                    }
                }

                const checkboxes = document.querySelectorAll('input[type="checkbox"]');

                window.addEventListener('load', () => {
                    checkboxes.forEach((checkbox) => {
                        const savedValue = sessionStorage.getItem(checkbox.id);

                        if (savedValue !== null) {
                            checkbox.checked = JSON.parse(savedValue);
                        } else {
                            checkbox.checked = false;
                            sessionStorage.setItem(checkbox.id, 'false');
                        }

                        checkbox.addEventListener('change', () => {
                            const isChecked = checkbox.checked;

                            sessionStorage.setItem(checkbox.id, isChecked.toString());

                        });
                    });
                });

                function resetProgress() {
                    document.getElementById('progressBar').style.width = '0%';
                    document.getElementById('progressBar').style.backgroundColor = '#2196f3'; // Cor azul
                }

                // Função para atualizar a barra de progresso com base no formulário
                function updateProgress(formType) {
                    let totalFields = 0;
                    let completedFields = 0;

                    // Seleciona os campos com base no tipo de formulário
                    let inputs;
                    let termsCheckbox;
                    if (formType === 'formAluno') {
                        inputs = document.querySelectorAll('#formAluno input:not([type="checkbox"])');
                        termsCheckbox = document.querySelector('#formAluno input[type="checkbox"]');
                        totalFields = camposAluno;
                    } else if (formType === 'formRecrutador') {
                        inputs = document.querySelectorAll('#formRecrutador input:not([type="checkbox"])');
                        termsCheckbox = document.querySelector('#formRecrutador input[type="checkbox"]');
                        totalFields = camposRecrutador;
                    } else if (formType === 'formEmpresa') {
                        inputs = document.querySelectorAll('#formEmpresa input:not([type="checkbox"])');
                        termsCheckbox = document.querySelector('#formEmpresa input[type="checkbox"]');
                        totalFields = camposEmpresa;
                    }

                    // Contagem dos campos preenchidos
                    inputs.forEach(input => {
                        if (input.value.trim() !== "") {
                            completedFields++;
                        }
                    });

                    // Adiciona o checkbox de "Concordar com os Termos" ao progresso
                    if (termsCheckbox && termsCheckbox.checked) {
                        completedFields++;
                    }

                    // Calcular o progresso em %
                    let progress = (completedFields / (totalFields + 1)) * 100; // +1 porque inclui a checkbox
                    document.getElementById('progressBar').style.width = progress + '%';

                    // Alterar a cor da barra de progresso
                    if (progress === 100) {
                        document.getElementById('progressBar').style.backgroundColor = '#4caf50'; // Cor verde
                    } else {
                        document.getElementById('progressBar').style.backgroundColor = '#2196f3'; // Cor azul
                    }
                }

                // Função para adicionar listeners de eventos aos campos de input
                function addInputListeners(formType) {
                    let inputs;
                    let termsCheckbox;
                    if (formType === 'formAluno') {
                        inputs = document.querySelectorAll('#formAluno input');
                        termsCheckbox = document.querySelector('#formAluno input[type="checkbox"]');
                    } else if (formType === 'formRecrutador') {
                        inputs = document.querySelectorAll('#formRecrutador input');
                        termsCheckbox = document.querySelector('#formRecrutador input[type="checkbox"]');
                    } else if (formType === 'formEmpresa') {
                        inputs = document.querySelectorAll('#formEmpresa input');
                        termsCheckbox = document.querySelector('#formEmpresa input[type="checkbox"]');
                    }

                    // Adiciona evento de input a cada campo
                    inputs.forEach(input => {
                        input.addEventListener('input', () => updateProgress(formType));
                    });

                    // Adiciona evento de mudança no checkbox
                    if (termsCheckbox) {
                        termsCheckbox.addEventListener('change', () => updateProgress(formType));
                    }
                }

                // Chamando a função para adicionar listeners ao carregar o formulário correspondente
                document.getElementById('userType').addEventListener('change', () => {
                    let userType = document.getElementById('userType').value;
                    if (userType === 'aluno') {
                        addInputListeners('formAluno');
                    } else if (userType === 'recrutador') {
                        addInputListeners('formRecrutador');
                    } else if (userType === 'empresa') {
                        addInputListeners('formEmpresa');
                    }
                });

            </script>

            <script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
            <script>
                new window.VLibras.Widget('https://vlibras.gov.br/app');
            </script>
            <!-- <script src="/js/script.js"></script> -->

</body>

</html>